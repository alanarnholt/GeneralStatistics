---
title: "Probability"
author: "Alan T. Arnholt"
date: '`r format(Sys.time(), "%b %d, %Y")`'
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = NA, prompt = TRUE)
```

## Basic Probability

* The set of all possible outcomes of a random experiment is called a _sample space_, $\Omega$. An event $E$ is a subset of $\Omega$.

**Three Axioms of Probability**

1. $0 \leq P(E) \leq 1)$
2. $P(\Omega)=1$
3. For any sequence of mutually exclusive events $E_1, E_2, \ldots$ (that is, $E_i \cap E_j = \emptyset$) for all ($i \neq j$),

$$P\left(\bigcup_{i=1}^{\infty} \right) = \sum_{i=1}^{\infty}P(E_i)$$

## Birthday Problem

Suppose that a room contains $m$ students.  What is the probability that at least two of them have the same birthday?  Start by assuming every day of the year is equally likely to be a birthday, and disregard leap years.  That is, assume there are always $n = 365$ days to a year.

## Birthday Problem - Solution

Let the event $E$ denote two or more students with the same birthday.  In this problem, it is easier to find $E^c$, as there are a number of ways that $E$ can take place.  There are a total of $365^m$ possible outcomes in the sample space.  $E^c$ can occur in $365\times 364 \times \cdots \times (365 - m + 1)$ ways.  Consequently,

$$P(E^c) = \frac{365\times 364 \times \cdots \times (365 - m + 1)}{365^m}$$
and

$$P(E) = 1 - \frac{365\times 364 \times \cdots \times (365 - m + 1)}{365^m}$$

## Some R

```{r, eval = FALSE}
m <- 1:60             # vector of number of students
p <- numeric(60)      # initialize vecotr to 0's
for(i in m){          # index value for loop
  q = prod((365:(365 - i + 1))/365)
  p[i] = 1 - q
}
plot(m, p, pch = 19,
     ylab = "P(at least two students with the same birthday)",
     xlab = "m = number of students in the room")
abline(h = 0.5, lty = 2, col = "blue")
abline(v = 23, lty = 2, col = "blue")
```

## Resulting Graph

```{r, echo = FALSE}
m <- 1:60             # vector of number of students
p <- numeric(60)      # initialize vecotr to 0's
for(i in m){          # index value for loop
  q = prod((365:(365 - i + 1))/365)
  p[i] = 1 - q
}
plot(m, p, pch = 19,
     ylab = "P(at least two students with the same birthday)",
     xlab = "m = number of students in the room")
abline(h = 0.5, lty = 2, col = "blue")
abline(v = 23, lty = 2, col = "blue")
```

## Conditional Probability

* If $E$ and $F$ are any two events in a sample space $\Omega$ and $P(E) \neq \emptyset$, the **conditional probability** of $F$ given $E$ is defined as

$$P(F|E) = \frac{P(F\cap E)}{P(E)}$$

## Example

Suppose two fair dice are rolled where each of the 36 possible outcomes is equally likely to occur.  Knowing that the first die shows a 3, what is the probability that the sum of the two dice equals 6?

* Define "the sum of the dice equals 6" to be event $A$ and "3 on the first toss" to be event $B$.

$$P(A|B) = \frac{P(A \cap B)}{P(B)} = \frac{1/36}{6/36}=\frac{1}{6}$$

## Law of Total Probability and Bayes' Rule

Let $F_1, F_2, \ldots F_n$ be such that $\bigcup_{i=1}^{n}F_i = \Omega$ and $F_i \cap F_j = \emptyset$ for all $i \neq j$, with $P(F_i) > 0$ for all $i$.  Then, for any event $E$,

$$P(E) = \sum_{i=1}^{n}P(E \cap F_i) = \sum_{i=1}^{n}P(E|F_i)P(F_i)$$

$$P(F_j|E) = \frac{P(E \cap F_j)}{P(E)} = \frac{P(E|F_i)P(F_i)}{\sum_{i=1}^{n}P(E|F_i)P(F_i)}  $$

## Choose a Door

The television show _Let's Make a Deal_ hosted by Monty Hall, gave contestants the opportunity to choose one of three doors.  Contestants hoped to choose the one that concealed the grand prize.  Behind the other two doors were much less valuable prizes.  After the contestant chose one of the doos, say Door 1, Monty opened one of the other two doors, say  Door3, containing a much less valuable prize.  The contestant was then asked whether he or she wished to stay with the original choice (Door 1) or switch to the other closed door (Door2).  What should the contestant do?  Is it better to stay with original choice of switch to the other closed door?

* What is the probability of winning by switching doors when given the opportunity?

* What is the probability of winning by staying with the initial selection?

## R - Code

```{r}
set.seed(13)
n <- 10000
actual <- sample(1:3, size = n, replace = TRUE)
aguess <- sample(1:3, size = n, replace = TRUE)
equals <- (actual == aguess)
PnoSwitch <- sum(equals)/n
PnoSwitch
```

## Random Variables

* A _discrete random variable_ $X$ is a function from $\Omega$ into the real numbers $\bf{R}$ with a range that is finite or countably infinite.  That is, $X: \Omega \rightarrow {x_1, x_2, \ldots, x_m}$, or $X:\Omega \rightarrow {x_1, x_2, \dots}$.

* A function $X$ from $\Omega$ into the real numbers $\bf{R}$ is a _continuous random variable_ if there exists a nonnegative function $f$ such that for every subset $C$ of $\bf{R}$, $P(X \in C) = \int_C\;f(x)\,dx$.  In particular, for $a \leq b$, $P(a < X \leq b) = \int_a^b\; f(x)\,dx.$


## Example

* Consider rolling two dice.  Let $X$ denote the sum of the two numbers that appear.  In this case, $X$ is a _discrete random variable_.  That is, $X:\Omega \rightarrow {2, 3, 4, \ldots, 11, 12}$.

```{r}
S <- expand.grid(roll1 = 1:6, roll2 = 1:6)
S$Sum <- apply(S, 1, sum)
head(S)
```

## Probability Density Function

The function $f$ is called the probability density function of $X$ and satisfies the following conditions:

* $f(x) > 0 , \quad x\in \Omega$
* $\int_{\Omega}\;f(x)\,dx = 1$
* If $(a, b) \subseteq \Omega$, then the probability of the event $\{a < X < b\}$ is
$$P(a < X < b) = \int_a^b\;f(x)\,dx$$

## Mean and Variance of _X_

* $$\mu_X = E(X) = \int_{-\infty}^{\infty}\;x\,f(x)\,dx $$

* $$\sigma^2 = \text{Var}(X) = E[(X - \mu_X)^2] = \int_{-\infty}^{\infty}(x - \mu_X)^2\;f(x)\,dx$$

## Example Mean and Variance

Let $X$ be a continuous random variable with _pdf_ $f(x) = 2x, 0 < x < 1$.  Find the mean and variance of $X$.

$$\mu_x = E(X) = \int_{0}^{1} x \cdot 2x\, dx = \frac{2}{3}x^3 \mid_0^1 = \frac{2}{3}$$

$$\sigma^2 = \text{Var}(X) = E(X^2) - \mu_X^2$$
$$\sigma^2 = \int_0^1 x^2(2x)\,dx - \left(\frac{2}{3}\right)^2 = \left[\left(\frac{1}{2}y^4 \right)\right]_0^1 - \frac{4}{9}= \frac{1}{18}$$

## Example (continued 1)

```{r}
f <- function(x){2*x}
integrate(f, 0, 1)
ex <- function(x){x*f(x)}
EX <- integrate(ex, 0, 1)
EX
EX <- MASS::fractions(EX$value)
EX
```

## Example (continued 2)

```{r}
g <- function(x){(x - 2/3)^2*f(x)}
VX <- integrate(g, 0, 1)
VX
VX <- MASS::fractions(VX$value)
VX
```

## Example (continued 3)

What is the area under $f$?

```{r, fig.height = 4, fig.width = 6, fig.align = "center"}
curve(f, 0, 1)
```

## Odds and Ends

* The standard deviation of $X$ is $\sigma_{X} = \sqrt{\text{Var}[X]}$

* If $X$ is a random variable and $a$ and $b$ are constants, then

$$E[a \pm bX] = a \pm bE[X]$$
$$\text{Var}[a \pm bX] = b^2\text{Var}[X] $$

## Sample of random variables

* Let $X_1, X_2, \ldots, X_n$ be _independent and identically distributed_ random variables with mean $\mu$ and variance $\sigma^2$.  Then

$$\bar{X} = \frac{1}{n}\sum_{i=1}^{n}X_i$$
is called the (_sample_) mean.

$$E[\bar{X}] = \mu_{\bar{X}} = \mu_{X} = \mu$$



* If $X_1, X_2, \ldots, X_n$ are _independent and identically distributed_ random variables with mean $\mu$ and variance $\sigma^2$, then

$$\text{Var}[\bar{X}] = \frac{\sigma^2_X}{n} = \frac{\sigma^2}{n}$$

## Z- score

$$Z = \frac{\text{statistic} - \mu_{\text{statistic}}}{\sigma_{\text{statistic}}}$$

* Suppose $X \sim N(\mu = 10, \sigma = 2)$ and one takes a random sample of size 4 and computes the sample mean to be 14.  What is the $Z-$score?

$$Z = \frac{\bar{X} - \mu_{\bar{X}}}{\sigma_{\bar{X}}} = \frac{14 - 10}{\frac{2}{\sqrt{4}}} = 4$$

## T- score

$$T = \frac{\text{statistic} - \mu_{\text{statistic}}}{\hat{\sigma}_{\text{statistic}}}$$

* Suppose $X \sim N(\mu = 10, \sigma = ?)$. The results from a random sample of size 4 are: 12, 14, 2, and 20.  What is the $T-$score?

```{r}
rs <- c(12, 14, 2, 20)
xbar <- mean(rs)
SD <- sd(rs)
Tscore <- (xbar - 10)/(SD/sqrt(4))
c(xbar, SD, Tscore)
```

$$T = \frac{\bar{X} - \mu_{\bar{X}}}{\hat{\sigma}_{\bar{X}}} = \frac{12 - 10}{\frac{7.483315}{\sqrt{}4}} = `r round(Tscore, 4)`$$